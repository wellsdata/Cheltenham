"0","# Load required libraries"
"0","library(readr)"
"0","library(writexl)"
"0",""
"0","# Set the folder path"
"0","folder_path <- ""/Users/gizmofo/Code/data_journalism_class/Cheltenham/scanned_short_form"""
"0",""
"0","# Get list of all text files in the folder"
"0","text_files <- list.files(folder_path, pattern = ""\\.txt$"", full.names = TRUE)"
"0",""
"0","# Create an empty list to store data frames"
"0","sheets_list <- list()"
"0",""
"0","# Read each text file and add to the list"
"0","for (file in text_files) {"
"0","  # Get the file name without path and extension for the sheet name"
"0","  sheet_name <- tools::file_path_sans_ext(basename(file))"
"0","  "
"0","  # Truncate sheet name to 31 characters (Excel limit)"
"0","  sheet_name <- substr(sheet_name, 1, 31)"
"0","  "
"0","  # Read the text file"
"0","  content <- read_lines(file)"
"0","  "
"0","  # Split each line into fields and results by comma"
"0","  fields <- character()"
"0","  results <- character()"
"0","  "
"0","  for (line in content) {"
"0","    # Split by comma"
"0","    parts <- strsplit(line, "","", fixed = TRUE)[[1]]"
"0","    "
"0","    # Handle cases where there might be more than 2 parts"
"0","    if (length(parts) >= 2) {"
"0","      fields <- c(fields, trimws(parts[1]))"
"0","      # Join remaining parts in case there are commas in the result"
"0","      results <- c(results, trimws(paste(parts[-1], collapse = "","")))"
"0","    } else if (length(parts) == 1) {"
"0","      # If no comma, treat whole line as field with empty result"
"0","      fields <- c(fields, trimws(parts[1]))"
"0","      results <- c(results, """")"
"0","    }"
"0","  }"
"0","  "
"0","  # Convert to data frame with two columns"
"0","  df <- data.frame("
"0","    Field = fields,"
"0","    Result = results,"
"0","    stringsAsFactors = FALSE"
"0","  )"
"0","  "
"0","  # Add to list with sheet name"
"0","  sheets_list[[sheet_name]] <- df"
"0","}"
"0",""
"0","# Write all sheets to Excel file"
"0","output_file <- file.path(folder_path, ""compiled_texts.xlsx"")"
"0","write_xlsx(sheets_list, output_file)"
"0",""
"0","cat(""Excel file created successfully at:"", output_file, ""\n"")"
"1","Excel file created successfully at:"
"1"," "
"1","/Users/gizmofo/Code/data_journalism_class/Cheltenham/scanned_short_form/compiled_texts.xlsx"
"1"," "
"1","
"
"0","cat(""Number of sheets:"", length(sheets_list), ""\n"")"
"1","Number of sheets:"
"1"," "
"1","40"
"1"," "
"1","
"
